// VS Code è°ƒè¯•é…ç½®æ¨¡æ¿
// ä½¿ç”¨æ–¹æ³•ï¼šå¤åˆ¶æ­¤æ–‡ä»¶ä¸º launch.jsonï¼ˆå³å»æ‰ .example åç¼€ï¼‰
// ä½ å¯ä»¥åœ¨ launch.json ä¸­è‡ªç”±æ·»åŠ æˆ–ä¿®æ”¹é…ç½®ï¼Œä¸ä¼šå½±å“ä»“åº“
{
  "version": "0.1.0",
  "configurations": [
    // ========== ä¸»ç¨‹åºè°ƒè¯•é…ç½® ==========
    // è°ƒè¯•ä¸»ç¨‹åºï¼ˆæœ€å¸¸ç”¨ï¼‰
    {
      "name": "Debug Main Program",
      "type": "go",
      "request": "launch",
      "mode": "auto",
      "program": "${workspaceFolder}/src/cmd/bililive",
      "args": [
        "-c",
        "${workspaceFolder}/config.yml"
      ],
      "cwd": "${workspaceFolder}"
    },
    // ä½¿ç”¨ build.go dev æ„å»ºå¹¶è¿è¡Œï¼ˆåŒ…å«å‰ç«¯ï¼‰
    {
      "name": "Run build.go dev",
      "type": "go",
      "request": "launch",
      "mode": "auto",
      "program": "${workspaceFolder}/build.go",
      "args": [
        "dev"
      ]
    },
    // é™„åŠ åˆ°æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹
    {
      "name": "Attach to Process",
      "type": "go",
      "request": "attach",
      "mode": "local",
      "processId": "${command:pickProcess}"
    },
    // ========== æœ¬åœ°è‡ªåŠ¨å‡çº§æµ‹è¯•é…ç½® ==========
    // å¯åŠ¨ Mock ç‰ˆæœ¬ API æœåŠ¡å™¨
    {
      "name": "Mock Version API Server",
      "type": "go",
      "request": "launch",
      "mode": "auto",
      "program": "${workspaceFolder}/test/update-mock-server",
      "args": [
        "-port",
        "8888",
        "-version",
        "99.0.0"
      ],
      "env": {
        "MOCK_CHANGELOG": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ç‰ˆæœ¬æ›´æ–°"
      }
    },
    // è°ƒè¯• Launcherï¼ˆä½¿ç”¨æœ¬åœ° Mock APIï¼‰
    // æ³¨æ„ï¼šéœ€è¦å…ˆåˆ›å»º test/launcher-config-local.jsonï¼Œå¯å‚è€ƒ test/launcher-config-local.example.json
    {
      "name": "Debug Launcher (Local Update)",
      "type": "go",
      "request": "launch",
      "mode": "auto",
      "program": "${workspaceFolder}/src/cmd/launcher",
      "args": [
        "-config",
        "${workspaceFolder}/test/launcher-config-local.json",
        "-verbose"
      ],
      "cwd": "${workspaceFolder}"
    },
    // è°ƒè¯•ä¸»ç¨‹åºï¼ˆæ¨¡æ‹Ÿç”± Launcher å¯åŠ¨ï¼‰
    {
      "name": "Debug Main Program (with Launcher)",
      "type": "go",
      "request": "launch",
      "mode": "auto",
      "program": "${workspaceFolder}/src/cmd/bililive",
      "args": [
        "-c",
        "${workspaceFolder}/config.yml"
      ],
      "env": {
        "BILILIVE_LAUNCHER": "1",
        "BILILIVE_INSTANCE_ID": "debug"
      },
      "cwd": "${workspaceFolder}"
    }
  ],
  "compounds": [
    // ä¸€é”®å¯åŠ¨æœ¬åœ°å‡çº§æµ‹è¯•ç¯å¢ƒï¼ˆMock API + Launcherï¼‰
    {
      "name": "ğŸš€ æœ¬åœ°å‡çº§æµ‹è¯• (Mock API + Launcher)",
      "configurations": [
        "Mock Version API Server",
        "Debug Launcher (Local Update)"
      ],
      "stopAll": true
    }
  ]
}